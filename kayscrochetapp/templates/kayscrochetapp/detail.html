{% extends 'base_generic.html' %}

{% block title %}{{ item.item_title }} Details{% endblock %}

{% if user.is_authenticated %}
{% block content %}
<form method="post" action="{% url 'kayscrochetapp:add_to_cart' pk=item.pk %}">
    {% csrf_token %}
    {{ form.as_p }}
    <button onmouseover="this.style.boxShadow='0 0 10px rgba(0, 0, 0, 0.5)'" onmouseout="this.style.boxShadow='none'" type="submit">ADD TO CART</button>
</form>
<form action="{% url 'kayscrochetapp:like' item.id %}" method="post">
{% csrf_token %}
    <fieldset>
        <legend><h1 style="text-transform: uppercase;">{{ item.item_title }} Details</h1></legend>
            <div style="padding: .5rem">
                {% if item.image %}
                    <img src="{{ item.image.url }}" alt="{{ item.item_title }}" style="width: 30%; height: auto;">
                {% endif %}
                {% if item.image2 %}
                    <img src="{{ item.image2.url }}" alt="{{ item.item_title }}" style="width: 30%; height: auto;">
                {% endif %}
            </div>
            <div style="padding: .5rem">
                {% if item.image3 %}
                    <img src="{{ item.image3.url }}" alt="{{ item.item_title }}" style="width: 30%; height: auto;">
                {% endif %}
                {% if item.image4 %}
                    <img src="{{ item.image4.url }}" alt="{{ item.item_title }}" style="width: 30%; height: auto;">
                {% endif %}
            </div>
        <h4>Description:</h4>
        <p>{{ item.description }}</p>
        <h4>Price:</h4>
        <p>${{ item.price }}</p>
        <h4>Published On:</h4>
        <p>{{ item.pub_date }}</p>
        <div class="d-flex justify-content-left align-items-center">
            <div>
               <a href="/like_item?item_id={{ item.id }}"  target="_blank" class="text-dark"><i class="fa fa-heart fa-2x" style="color: red;"></i></a>
            </div>
            <div>
                {% if item.no_of_likes == 0 %}
                <p>'s 0</p>
                {% elif item.no_of_likes == 1 %}
                <p>'s {{item.no_of_likes}}</p>
                {% else %}
                <p>'s {{item.no_of_likes}}</p>
                {% endif %}
            </div>
        </div>
        {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
        {% if item.choice_set.count > 0 %}
            <h4>Vote on Styles For Kay's Crochet To Make:</h4>
            {% for choice in item.choice_set.all %}
                <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}">
                <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br>
            {% endfor %}
        {% endif %}
        {% if item.choice_set.count > 0 %}
            <input type="submit" value="VOTE FOR STYLES" onmouseover="this.style.boxShadow='0 0 10px rgba(0, 0, 0, 0.5)'" onmouseout="this.style.boxShadow='none'" style="display: flex; justify-content: center; align-items: center; vertical-align: middle; line-height: 0;">
            <button type="button" onmouseover="this.style.boxShadow='0 0 10px rgba(0, 0, 0, 0.5)'" onmouseout="this.style.boxShadow='none'" class="button" onclick="window.location.href = '{% url 'kayscrochetapp:results' item.id%}'">SEE STYLE VOTES</button>
        {% endif %}
    </fieldset>
</form>
<form method="post" action="{% url 'kayscrochetapp:add_to_cart' pk=item.pk %}">
    {% csrf_token %}
    {{ form.as_p }}
    <button onmouseover="this.style.boxShadow='0 0 10px rgba(0, 0, 0, 0.5)'" onmouseout="this.style.boxShadow='none'" type="submit">ADD TO CART</button>
</form>
{% endblock %}
{% endif %}